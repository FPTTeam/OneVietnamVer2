
@using MongoDB.Driver.Linq
@using OneVietnam.DTL;
@model OneVietnam.Models.PostViewModel
@{
    ViewBag.Tiltel = "EditPost";
    List<Tag> tagList = ViewData["TagList"] as List<Tag>;
    List<Icon> postTypes = ViewData["PostTypes"] as List<Icon>;

}

<script src="~/Scripts/jquery-1.10.2.js"></script>

<div style="margin: auto; width: 40%">
    @using (Html.BeginForm("EditPost", "Post", FormMethod.Post))
    {

        if (Model != null && (Model.DeletedFlag == false) && (Model.LockedFlag == false))
        {
            @Html.AntiForgeryToken()
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            <div class="ui segments" style="width: 100%; border: 0 !important;">

                @*Title area *@
                <div class="ui segment" style="width: 100%; border: 0 !important;">
                    <div class="ui left icon big input" style="width: 100%;">
                        <input id="Title" name="Title" placeholder="Nhập tiêu đề" type="text" value="@Model.Title">
                        <i class="star icon"></i>
                    </div>
                </div>

                @*Illustration Area*@
            <div class="ui segment" style="width: 100%; border: 0 !important; padding-top: 0">
                @*<div class="dropzone" id="myId">
                        <div class="fallback">
                            <input id="files" multiple="" name="files" type="file">
                        </div>
                    </div>*@
                
                
            </div>
                

                @*Post Status*@
                <div class="ui segment" style="width: 100%; border: 0 !important; padding-top: 0">
                    <div class="ui toggle checkbox">
                        <input data-val="true" checked="@Model.Status" id="Status" name="Status" type="checkbox" value="true" onchange="ChangeStatus()" />
                        <input name="Status" type="hidden" value="@Model.Status" />
                        @if (Model.Status)
                        {
                        <label id="LblStatus">Đóng bài đăng</label>
                        }
                        else
                        {
                        <label id="LblStatus">Mở bài đăng</label>
                        }
                    </div>
                    <script>
                        function ChangeStatus() {
                            var chkStt = document.getElementById("Status");
                            var lblStt = document.getElementById("LblStatus");
                            if (chkStt.checked) {
                                lblStt.innerText = "Đóng bài đăng";
                            } else {
                                lblStt.innerText = "Mở bài đăng";
                            }
                        };
                    </script>
                </div>

                @*Post Type*@
                <div class="ui segment" style="width: 100%; border: 0 !important; padding-top: 0">
                    <div class="ui selection dropdown" id="drPostType" style="width: 100%; min-width: 100%">
                        <i class="filter icon"></i>
                        <input type="hidden" id="PostType" name="PostType" value="@Model.PostType">
                        <i class="dropdown icon"></i>
                        <div class="default text">Chọn loại bài đăng</div>
                        <div class="menu">
                            @{
                                if (postTypes != null)
                                {
                                    foreach (Icon icon in postTypes)
                                    {
                            <div class="item" data-value="@icon.IconId">
                                @icon.IconText
                            </div>
                                    }
                                }
                            }

                        </div>
                    </div>

                </div>

                @*Address*@
                <div class="ui segment" style="width: 100%; border: 0 !important; padding-top: 0">
                    <div class="ui left icon input" style="width: 100%;">
                        <input placeholder="Nhập địa chỉ" id="PostLocation_Address" name="PostLocation.Address" type="text" value="@Model.PostLocation.Address" />
                        <i class="home icon"></i>
                    </div>

                </div>

                @*Description Area*@
                <div class="ui segment" style="width: 100%; border: 0 !important; padding-top: 0">
                    <textarea id="Description" name="Description" onkeydown="setHeight('Description')" onkeyup="setHeight('Description')" style="text-align: justify; width: 100%; max-width: 100%;">@Model.Description</textarea>
                    <script type="text/javascript">
                        function setHeight(fieldId) {
                            document
                                .getElementById(fieldId)
                                .style.height = document.getElementById(fieldId).scrollHeight + 'px';
                        }

                        setHeight('Description');
                    </script>
                </div>

                @*Related Tags*@
                <div class="ui segment" style="width: 100%; border: 0 !important; padding-top: 0">
                    <div class="ui fluid multiple search selection dropdown">
                        @{
                            string tagValue = "";
                            if (Model.Tags != null)
                            {
                                foreach (var tag in Model.Tags)
                                {
                                    tagValue = string.IsNullOrEmpty(tagValue) ? tag.TagValue : string.Concat(tagValue + ",", tag.TagValue);
                                }
                            }

                        }
                        <input name="TagsInput" id="TagsInput" type="hidden" value="@tagValue">
                        <i class="tags icon"></i>
                        <input class="search" autocomplete="off" tabindex="0"><span class="sizer"></span>
                        <div class="default text" style="padding-left: 1.5rem">Thẻ liên quan</div>
                        <div class="menu transition hidden" tabindex="-1">

                            @{
                                if (tagList != null)
                                {
                                    foreach (Tag tag in tagList)
                                    {
                            <div class="item" data-value="@tag.TagValue">@tag.TagText</div>
                                    }
                                }
                            }

                        </div>
                    </div>
                </div>

                @*Button Save and Cancel*@
                <div class="ui segment" style="width: 100%; border: 0 !important; padding-top: 0; text-align: center">
                    <input type="button" class="ui cancel  button" value="Hủy" />
                    <input type="submit" class="ui positive  button" value="Lưu" />
                </div>

                @*User ID, Post ID, Publish Date*@
                <div style="display: none">
                    @Html.EditorFor(model => model.Id)
                    @Html.EditorFor(model => model.UserId)
                    @Html.EditorFor(model => model.PublishDate)                    
                </div>

            </div>

                                }
                                else
                                {
                                    <div class="ui segment">
                                        <div class="ui centered header">
                                            <i class="warning circle icon"></i>
                                            Trang bạn tìm kiếm đã bị xóa hoặc không tồn tại
                                        </div>
                                    </div>
                                    }

                                }
</div>

@using OneVietnam.DTL
@using OneVietnam.Models
@model OneVietnam.Models.PostViewModel

@{
    ViewBag.Title = "ShowPostDetail";    
    List<Icon> postTypes = ViewData["PostTypes"] as List<Icon>;
    PostViewModel post = ViewData["PostView"] as PostViewModel;
}
<script src="~/Scripts/jquery-1.10.2.js"></script>
<link rel="stylesheet" href="~/Content/image-slider.css">
<div class="ui fullscreen scrolling modal">
    <div class="modal-container">
        @using (Html.BeginForm("ShowPostDetail", "Post", FormMethod.Post))
        {
            if (post != null)
            {
                <div class="header">
                    <div class="ui menu item" style="border: 0; box-shadow: 0 0 !important">
                        <a href="http://google.com">
                            <img class="ui middle aligned rounded tiny image" src="/Images/dat.JPG">
                            <span class="ui header">@post.UserName</span>
                    </a>

                    <div class="menu right">
                        <label class="ui item header" style="height: 100%">@post.Title</label>
                    </div>
                </div>
            </div>

            <div class="image content" style="max-height: 60vh !important">
                <div class="ui image" style="width: 60%;">
                    <table style="width: 100%; height: 100%;">
                        <tr>
                            <td style="width: 8%; text-align: left !important;">
                                <a class="prev" onclick="plusSlides(-1)">❮</a>
                            </td>
                            <td style="width: 84%; text-align: center">
                                <div class="ui people shape">
                                    <div class="sides fade">
                                        @{
                                            
                                                if (post.Illustrations == null | (post.Illustrations != null && post.Illustrations.Count <= 0))
                                                {
                                                    <div class="side active">
                                                        <div class="ui card" style="width: auto !important; max-height: 100%">
                                                            <div class="image">
                                                                <img src="/Images/no-image.png" style="max-height: 50vh !important; max-width: 100% !important; width: auto !important" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                                else
                                                {
                                                    foreach (var ill in post.Illustrations)
                                                    {
                                                        if (post.Illustrations.IndexOf(ill) == 0)
                                                        {
                                                            <div class="side active">
                                                                <div class="ui card" style="width: auto !important; max-height: 100%">
                                                                    <div class="image">
                                                                        <img src="@ill.PhotoLink" style="max-height: 60vh !important; max-width: 100% !important; width: auto !important" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            <div class="side fade">
                                                                <div class="ui card" style="width: auto !important; max-height: 100%">
                                                                    <div class="image">
                                                                        <img src="@ill.PhotoLink" style="max-height: 60vh !important; max-width: 100% !important; width: auto !important" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                    <div style="text-align: center">
                                                        @for (int index = 1; index < post.Illustrations.Count + 1; index++)
                                                        {
                                                            <span class="dot" onclick="currentSlide(@index)"></span>
                                                        }

                                                    </div>
                                                }
                                            

                                        }
                                    </div>
                                </div>
                            </td>
                            <td style="width: 8%; text-align: right !important">
                                <a class="next" onclick="plusSlides(1)">❯</a>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="description" style="width: 40%;">
                    <div class="ui very relaxed selection list">
                        <div class="item">
                            <div id="fb-root"></div>
                            <script>
                            (function (d, s, id) {
                                var js, fjs = d.getElementsByTagName(s)[0];
                                if (d.getElementById(id)) return;
                                js = d.createElement(s);
                                js.id = id;
                                js.src = "//connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v2.6";
                                fjs.parentNode.insertBefore(js, fjs);
                            }(document, 'script', 'facebook-jssdk'));
                            </script>
                            <div class="ui horizontal list">
                                <div class="item">
                                    <script>
                                    //like button
                                    document.write("<div class='fb-like' data-href='" +
                                        window.location.href +
                                        "' data-layout='button_count' data-action='like' data-size='large' data-show-faces='false' data-share='false'></div>");
                                    </script>
                                </div>
                                <div class="item">
                                    <script>
                                    //share button
                                    document.write("<div class='fb-share-button' data-href='" +
                                        window.location.href +
                                        "' data-layout='button_count' data-size='large' data-mobile-iframe='true'>" +
                                        "<a class='fb-xfbml-parse-ignore' target='_blank' href='" +
                                        window.location.href +
                                        "'>Chia sẻ</a>" +
                                        "</div>");
                                    </script>
                                </div>

                            </div>
                        </div>
                        <div class="item">
                            <div class="ui header">
                                <i class="calendar icon"></i>
                                <div class="content">
                                    @($"{post.PublishDate:dd/MM/yyyy}")
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="ui header">
                                @{
                                    if (postTypes != null)
                                    {
                                        foreach (Icon icon in postTypes)
                                        {
                                            if (icon.IconId == post.PostType)
                                            {
                                                <img class="ui mini avatar image" src="@icon.IconImage" />
                                                <div class="content">
                                                    @icon.IconText
                                                </div>
                                            }
                                        }
                                    }
                                }

                            </div>
                        </div>
                        <div class="item">
                            <div class="ui header">
                                <i class="home icon"></i>
                                <div class="content">
                                    <a href="">@post.PostLocation.Address</a>
                                </div>

                            </div>

                        </div>

                        @{if (post.Tags != null)
                            {
                                <div class="item">
                                    <div class="ui header">
                                        <i class="tags icon"></i>
                                        <div class="content">
                                            @foreach (var tag in post.Tags)
                                            {
                                                <a href="">@tag.TagText</a>
                                            }
                                        </div>
                                    </div>
                                </div>
                            }
                        }

                        <div class="item">
                            <div class="ui green header">
                                <i class="pin icon"></i>
                                @if (post.Status)
                                {
                                    <div class="content">
                                        Đang hoạt động
                                    </div>
                                }
                                else
                                {
                                    <div class="content">
                                        Đã đóng
                                    </div>
                                }
                            </div>

                        </div>
                        <div class="actions">

                            @if (User.Identity.IsAuthenticated)
                            {
                                <button class="positive ui button" onclick="document.location.href = '@Url.Action("EditPost", "Post", new {postId = post.Id})';">Sửa bài đăng</button>
                                <button class="negative ui button" onclick="document.location.href = '@Url.Action("DeletePost", "Post", new {postId = post.Id})';">Xóa bài đăng</button>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <div class="image content" style="padding-top: 5% !important">
                <div class="ui image" style="width: 60%;">
                    <script>
                    document.write("<div class='fb-comments' style='width: 100%' data-href='" +
                        window.location.href +
                        "' data-numposts='3' ></div>");
                    </script>
                </div>
                <div class="description header" style="width: 40%;">
                    <div class="ui very relaxed selection list">
                        <div class="item">
                            <div class="ui header">
                                <i class="edit icon"></i>
                                <div class="content">
                                    Mô tả chi tiết
                                </div>
                                <div class="sub header">
                                    @post.Description
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
                                }


                            }
   </div>
</div>


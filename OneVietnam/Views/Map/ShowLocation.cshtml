@using OneVietnam.DTL;

@model IEnumerable<OneVietnam.Models.AddLocationViewModel>

@{
    ViewBag.Title = "ShowLocation";
}

<script>
    var isAuthenticated;
</script>
@using Microsoft.AspNet.Identity
@if (Request.IsAuthenticated)
{
    <script>
        isAuthenticated = true;
    </script>
}
else
{

    <script>
        isAuthenticated = false;
    </script>
}


<head>
    <meta charset="utf-8" />
    <title>MAP</title>

    <link href="~/Content/Map/infoWindow.css" rel="stylesheet">
    <link href="~/Content/Map/map.css" rel="stylesheet">
    <link href="~/Content/Map/searchbox.css" rel="stylesheet">
    <script type="text/javascript">

        var array = [];
        var PostArray = [];
        var postType0 = [];
        var postType1 = [];
        var postType2 = [];

        @foreach (var item in Model) {
        <text>
        array.push({x :@item.x ,y : @item.y, address: '@item.address', userID :'@item.userid'});

        @try {
            if (@item.Posts != null) {
                if (@item.Posts.Count > 0) {
                    foreach (var post in @item.Posts) {

                        if(@post.PostType.CompareTo(0) == 0)
                        {
                            @:postType0.push({postID: '@post.Id',username: '@post.Username',postType : @post.PostType, deletedFlag : '@post.DeletedFlag', status : '@post.Status', x: @post.PostLocation.XCoordinate, y: @post.PostLocation.YCoordinate, address : '@post.PostLocation.Address'});
                                }
                        else
                        if (@post.PostType.CompareTo(0) == 0)
                        {
                              @:postType1.push({postID: '@post.Id',username: '@post.Username',postType : @post.PostType, deletedFlag : '@post.DeletedFlag', status : '@post.Status', x: @post.PostLocation.XCoordinate, y: @post.PostLocation.YCoordinate, address : '@post.PostLocation.Address'});
                        }

                @:PostArray.push({postID: '@post.Id',username: '@post.Username',postType : @post.PostType, deletedFlag : '@post.DeletedFlag', status : '@post.Status', x: @post.PostLocation.XCoordinate, y: @post.PostLocation.YCoordinate, address : '@post.PostLocation.Address'});
                                      }
                    }

                }
            }
            catch (ArgumentException e) {
                // throw new YourCustomException("Put your error message here.", e);
            }



        </text>
        }




    </script>
    
    <script type="text/javascript" src="~/Scripts/map.js"></script>
    <script type="text/javascript" src="~/Scripts/markerclusterer.js"></script>


    <!-- Custom Fonts -->
    <!--<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  


</head>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.x)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.y)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.address)
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.x)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.y)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.address)
            </td>

            <td>
                @Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ }) |
                @Html.ActionLink("Details", "Details", new { /* id=item.PrimaryKey */ }) |
                @Html.ActionLink("Delete", "Delete", new { /* id=item.PrimaryKey */ })
            </td>
        </tr>
    }

</table>
<body>

    <div class="ui grid container">
        </div>
        <div class="container text-center" style="height:100%;">
            <div class="row" style="height:70%;">

                <div class="col-sm-12" style="height:800px;">
                    <div id="map_canvas" style="width:100%;height:500px;"></div>
                    <input id="pac-input" class="controls" type="text" placeholder="Search Box" style="z-index: 0; position: absolute; left: 114px; top: 10px;">
                    @*<button type="button" onclick="showCurrentLocation()"><img src="~/images/currentLocationButton.png" class="img-rounded" alt="Cinque Terre" style="z-index: 0; width:30px;height:30px"></button>*@
                    @*background-image: url('../Images/currentLocationButton.png');*@
                    <p id="cal"></p>
                    <button type="submit" onclick="showCurrentLocation()" style=" width:100px; height:30px;">My location</button>
                </div>

            </div>

            <div class="row">
                <div class="ui vertical animated button" tabindex="0">
                    <div class="hidden content">Shop</div>
                    <div class="visible content">
                        <i class="shop icon"></i>
                    </div>
                </div>

            </div>
        </div>

</body>


